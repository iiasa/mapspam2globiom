<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Get started • mapspam2globiom</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Get started">
<meta property="og:description" content="mapspam2globiom">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mapspam2globiom</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Background
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction.html">1. Introduction</a>
    </li>
    <li>
      <a href="../articles/model_dimensions.html">2. Model dimensions</a>
    </li>
    <li>
      <a href="../articles/input_data.html">3. Input data</a>
    </li>
    <li>
      <a href="../articles/appendix.html">4. Appendix</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Get started
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/software.html">1. Software and hardware</a>
    </li>
    <li>
      <a href="../articles/template.html">2. Template</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Running SPAMc
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/setup.html">1. Model setup</a>
    </li>
    <li>
      <a href="../articles/process_subnat_stat.html">2. Process subnational statistics</a>
    </li>
    <li>
      <a href="../articles/process_spatial_data.html">3. Process spatial data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/iiasa/mapspam2globiom">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Get started</h1>
            
      
      
      <div class="hidden name"><code>software.Rmd</code></div>

    </div>

    
    
<p>To run SPAMc, one needs a combination of software packages, including R (and RStudio), GAMS and GDAL. Below, we provide a brief description on how to install the software and point towards several other pieces of software and tools that are useful, although not strictly necessary to run SPAMc. Note that the scripts and implementation of the model have been developed, implemented and tested using a windows environment. As all the software is cross platform it should be possible to run SPAMc on Mac and Linux but this has not been tested.</p>
<div id="installing-r-and-rstudio" class="section level2">
<h2 class="hasAnchor">
<a href="#installing-r-and-rstudio" class="anchor"></a>Installing R and RStudio</h2>
<p>All the pre- and postprocessing of the data is done in R <span class="citation">(R Core Team 2018)</span>. R is a free and open source software environment for statistical computing and graphics supported by the R Foundation for Statistical Computing. To run SPAMc one needs to install R and RStudio, a graphical user interface for R. Both pieces of software are is available for various operating systems. We recommend using the second to last release of R as it takes some time before all packages are updated, potentialy causing errors (see below for more information on R packages). If you are not familiar with R, please have a look at the online book <a href="https://r4ds.had.co.nz">R for Data Science</a> by Hadley Wickham and Garrett Grolemund, which is probably the best book to get you started.</p>
<ol style="list-style-type: decimal">
<li><a href="https://cran.r-project.org/">Download and install R</a></li>
<li>
<a href="https://rstudio.com/products/rstudio/download/">Download and install Rstudio</a>.</li>
</ol>
</div>
<div id="installing-gams" class="section level2">
<h2 class="hasAnchor">
<a href="#installing-gams" class="anchor"></a>Installing GAMS</h2>
<p>The SPAMc model is solved using the <a href="https://www.gams.com/">General Algebraic Modeling System</a> (GAMS), which is modelling system and language designed for mathematical optimization. The GAMS system and solvers can be downloaded from the GAMS website. Unfortunately, one needs a GAMS Base Module licence plus additional Mosek solver licence to run the SPAMc model<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<ul>
<li><a href="https://www.gams.com/download">Download and install GAMS</a></li>
</ul>
</div>
<div id="installing-gdal" class="section level2">
<h2 class="hasAnchor">
<a href="#installing-gdal" class="anchor"></a>Installing GDAL</h2>
<p>A lot of SPAMc’s input data is spatially explicit and comes in the format of maps, which can be in vector/polygon or raster format. Although most of the map processing can be done within R, We mostly use <a href="https://gdal.org/">Geospatial Data Abstraction Library</a> (GDAL) for this type of operations as it tends to be much faster. GDAL is a free computer software library for reading and writing raster and vector geospatial data formats, developed by the Open Source Geospatial Foundation.</p>
<ul>
<li>
<a href="https://trac.osgeo.org/osgeo4w">Dowload and install GDAL</a><a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>
</li>
</ul>
</div>
<div id="additional-software" class="section level2">
<h2 class="hasAnchor">
<a href="#additional-software" class="anchor"></a>Additional software</h2>
<p>Although not strictly necessary to use SPAMc, We recommend installing the following additional software:</p>
<ul>
<li><p><a href="https://miktex.org">MikTeX</a> is (one of) implementations of TeX/LaTeX and related programs. RStudio facilitates the use of LaTex through Rmarkdown but this requires the installation of.</p></li>
<li><p><a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git">Git</a> is software to version your code. RStudio and git can be easily linked to version your code. We use it in combination with <a href="https://github.com">GitHub</a> to store code in the cloud and facilitate collaborative code development.</p></li>
<li><p><a href="https://qgis.org/en/site/">QGIS</a> a free and open-source cross-platform desktop geographic information system application that supports viewing, editing, and analysis of geospatial data. We sometimes use it to quickly inspect vector and raster maps.</p></li>
</ul>
</div>
<div id="storate-and-formats-of-model-input-and-output" class="section level2">
<h2 class="hasAnchor">
<a href="#storate-and-formats-of-model-input-and-output" class="anchor"></a>Storate and formats of model input and output</h2>
<p>Depending on the resolution of the model and the size of the country, the size of the input (raw and processed) and output files can become quite large. Hence it is important to ensure sufficient disk space to store the files. To give you an idea, all files related to the China example have a total size of <span class="citation">(<span class="citeproc-not-found" data-reference-id="ADD"><strong>???</strong></span>)</span>, while the total size for the Malawi example is <span class="citation">(<span class="citeproc-not-found" data-reference-id="ADD"><strong>???</strong></span>)</span>. We also encountered some problems when performing some of the GDAL operations using DropBox, probably related to the synchronization of files. If you encounter problems when saving to Dropbox, try saving to a folder that is not being synchronizated automatically.</p>
<p>In most cases we use the following file formats to store data: - Raster maps are stored using Geotiff (*.tif). - Shape files (i.e. vector/polygon data) are stored in the R .rds data format, which ensures the data structure is maintained and data can be quickly loaded into R. The shapefile with ADM information is also saved in .shp format as this is needed for GDAL. - Data files are stored in the R .rds data format. For files with lists of information (e.g. list of crops and ADMs in the country) we use .csv files for quick referencing (e.g. using Excel). - GAMS code is saved in .gms <span class="citation">(<span class="citeproc-not-found" data-reference-id="UPDATE"><strong>???</strong></span>)</span> - GAMS data files are stored in .gdx <span class="citation">(<span class="citeproc-not-found" data-reference-id="UPDATE"><strong>???</strong></span>)</span></p>
</div>
<div id="r-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#r-packages" class="anchor"></a>R packages</h2>
<div id="installing-r-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#installing-r-packages" class="anchor"></a>Installing R packages</h3>
<p>R packages are pieces of bundled R code, frequently including scripts from other languages (e.g. C or C++) to speed up calculations or interface with other software (e.g. GAMS). Packages can be easily installed by typing `install.packages(“PACKAGE_NAME”) in R or by clicking on the ‘package’ tab in RStudio. Nearly all packages are directly downloaded from CRAN, the R package repository, on your system.</p>
<p>To install mapspam, which is not on CRAN, one first has to install the devtools package (if not already installed) <span class="citation">(<span class="citeproc-not-found" data-reference-id="ADD"><strong>???</strong></span> package name)</span>:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"devtools"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">devtools</span>)
<span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"michielvandijk/mapspam"</span>)</pre></body></html></div>
<p>To interface between R and GAMS the GDXRRW package is required. This package is also not available on CRAN and therefore cannot be installed using the standard approach. Hence, one has to install it manually. The package can be found <a href="https://support.gams.com/gdxrrw:interfacing_gams_and_r">here</a></p>
<p>To install GDXRRW <span class="citation">(<span class="citeproc-not-found" data-reference-id="ADD"><strong>???</strong></span> need to solve this using one approach)</span>:</p>
<ol style="list-style-type: decimal">
<li>Copy the GDXRRW.zip to a temporary folder on your machine. Note that the version of GDXRRW has to match your R version, otherwise there might be an error! Thus, if you have R version 3.5.X install the GDXRRW version that is built with R 3.5.x.</li>
<li>Click ‘Packages’ &gt; ‘install’ in RStudio</li>
<li>Select ’Install from: Package Archive File (.zip; .tar; .gz)</li>
<li>Select GDXRRW.zip to install the package in your R library</li>
</ol>
<p>For GDXRRW to work and to be able to read gdx files, the package needs to link with GAMS. This can be done manually using the following code. If the link is created you should get the message <code>The GDX library has been loaded</code>.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co"># Where C:/GAMS/win64/25.0 is the location of the gams.exe</span>
<span class="no">gams_path</span> <span class="kw">&lt;-</span> <span class="st">"C:/GAMS/win64/25.0"</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">gdxrrw</span>)
<span class="fu"><a href="https://rdrr.io/pkg/gdxrrw/man/igdx.html">igdx</a></span>(<span class="no">gams_path</span>)</pre></body></html></div>
<p>If the location of GAMS is added to the PATH on windows or LD_LIBRARY_PATH on Linux, this command is not necessary anymore. To add GAMS to the Windows path type “edit the system environment variables” in the Search Windows bar at the bottom of your Windows session. Click “Environment Variables”, select “Path”, click “Edit”, click “New” and add (in this case) “C:/GAMS/win64/25.0” to the PATH list.</p>
</div>
<div id="essential-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#essential-packages" class="anchor"></a>Essential packages</h3>
<p>Apart from mapspam and GDXRRW, a number of R packages are needed to peform the tasks related to SPAMc. Most important are:</p>
<ul>
<li><p><a href="https://cran.r-project.org/web/packages/tidyverse/index.html">tidyverse</a> <span class="citation">(Wickham et al. 2019)</span>, is the name for a set of packages that work in harmony to facilitate data preparation and processing, most importantly dplyr, purrr, tidyr and ggplot2. Some of them are used by the mapspam package and will be installed automatically when mapspam is installed for the first time if they have not been installed before.</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/sf/index.html">sf package</a> <span class="citation">(Pebesma 2018)</span></p></li>
<li><p><a href="https://cran.r-project.org/web/packages/raster/index.html">raster package</a> <span class="citation">(Hijmans 2020)</span></p></li>
</ul>
</div>
</div>
<div id="hardware" class="section level2">
<h2 class="hasAnchor">
<a href="#hardware" class="anchor"></a>Hardware</h2>
<p>The dimensions of SPAMc are determined by the number of grid cells x number of administrative regions x number of crops x number of farming systems. Of these four elements, the number of grid cells is the main factor determining the size of the model although the other dimensions (in combination with grid cells) also play a role. The total number of grid cells is related to (1) the cropland extent and, hence, size of the country and (2) the resolution of the model, e.g. 30 arcsec or 5 arcmin.</p>
<p>When the model is run at higher resolution, the number of dimensions quickly tends to become very large (e.g. <span class="citation">(<span class="citeproc-not-found" data-reference-id="ADD"><strong>???</strong></span>)</span> number of equations). Excessively large models will result in memory problems or very long processing times on an desktop machine. These models can only be solved by splitting the problem into pieces as illustrated by the China example and/or reducing the resolution of the model. We succesfully managed to run 30 arcsec single country models for small to medium size African countries, such as Malawi, Zambia and Kenya on a Windows 10 desktop with <span class="citation">(<span class="citeproc-not-found" data-reference-id="ADD"><strong>???</strong></span>)</span>. However, we did not manage to run this model for Ethiopia, which is characterized by much larger cropland area and administrative zones. When we tried to run the model on the desktop, GAMS indicated there was not enough RAM available. To solve this issue we tried to run the model on high-memory machine with <span class="citation">(<span class="citeproc-not-found" data-reference-id="ADD"><strong>???</strong></span>)</span> memory. The model started to run succesfully but due to the high number of dimensions, it was not solved after a week, resulting in a time-out error. <span class="citation">(<span class="citeproc-not-found" data-reference-id="ADD"><strong>???</strong></span>)</span> eventually we split the model into <span class="citation">(<span class="citeproc-not-found" data-reference-id="adm"><strong>???</strong></span>)</span> units and solved the model. Disadvantage of splitting the model is that assumptions need to be made on crop area by adminstrative 1 unit if this data is not available (see Chapter @(overview)). We recommend running the model at 5 arcmin first to test the model behaviour and only then decide on how to proceed with higher resolution models if needed.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-Hijmans2020">
<p>Hijmans, Robert J. 2020. “raster: Geographic Data Analysis and Modeling.” <a href="https://cran.r-project.org/package=raster">https://cran.r-project.org/package=raster</a>.</p>
</div>
<div id="ref-Pebesma2018">
<p>Pebesma, Edzer. 2018. “Simple Features for R: Standardized Support for Spatial Vector Data.” <em>The R Journal</em> 10 (1): 439. <a href="https://doi.org/10.32614/RJ-2018-009">https://doi.org/10.32614/RJ-2018-009</a>.</p>
</div>
<div id="ref-RCoreTeam2018">
<p>R Core Team. 2018. “R: A Language and Environment for Statistical Computing.” R Foundation for Statistical Computing. <a href="https://www.r-project.org/">https://www.r-project.org/</a>.</p>
</div>
<div id="ref-Wickham2019">
<p>Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy McGowan, Romain François, Garrett Grolemund, et al. 2019. “Welcome to the Tidyverse.” <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>We are exploring the possibility to solve SPAMc directly in R using the <a href="https://cran.r-project.org/web/packages/Rmosek/index.html">Rmosek</a> package. As Mosek offers unrestricted trial and academic licence, using this package would make the use of GAMS, and the need of a paid licence, superfluous. At the moment it is not clear yet if this alternative is technicallly possible.<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>We prefer to install from OSGeo4W, which is a collection of open source geospatial software for windows that also includes QGIS (see below). GDAL for other systems than windows can be downloaded <a href="https://gdal.org/download.html">here</a>.<a href="#fnref2" class="footnote-back">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Michiel Van Dijk.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
